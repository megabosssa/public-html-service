<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thymeleaf Template Tester - Full Spring Boot Support</title>
    <link rel="icon" type="image/svg+xml" href="../../assets/images/favicon.svg">
    <meta name="description" content="Online Thymeleaf template testing tool with full Spring Boot Thymeleaf support.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        /* ===== CSS Variables & Theme ===== */
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-input: #0d1117;
            --border-primary: #30363d;
            --border-secondary: #21262d;
            --border-accent: #388bfd;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-blue: #58a6ff;
            --accent-cyan: #39c5cf;
            --accent-green: #3fb950;
            --accent-purple: #a371f7;
            --accent-orange: #d29922;
            --accent-red: #f85149;
            --gradient-accent: linear-gradient(135deg, #58a6ff 0%, #39c5cf 100%);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5);
            --radius-sm: 6px;
            --radius-md: 8px;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            --transition-fast: 150ms ease;
        }

        /* ===== Reset & Base ===== */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: var(--font-sans);
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
        }

        /* ===== Header ===== */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-primary);
            padding: 12px 20px;
            flex-shrink: 0;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 28px;
            height: 28px;
            color: var(--accent-cyan);
            filter: drop-shadow(0 0 8px rgba(57, 197, 207, 0.4));
        }

        .logo h1 {
            font-size: 20px;
            font-weight: 700;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-badges {
            display: flex;
            gap: 8px;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .badge-info {
            background: rgba(88, 166, 255, 0.15);
            color: var(--accent-blue);
            border: 1px solid rgba(88, 166, 255, 0.3);
        }

        /* ===== Toolbar ===== */
        .toolbar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-primary);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            flex-shrink: 0;
            flex-wrap: wrap;
        }

        .toolbar-left,
        .toolbar-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toolbar-label {
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
        }

        .btn-group {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        /* ===== Buttons ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border-radius: var(--radius-sm);
            font-family: var(--font-sans);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: none;
            outline: none;
        }

        .btn-icon {
            width: 16px;
            height: 16px;
        }

        .btn-primary {
            background: var(--gradient-accent);
            color: #0d1117;
            box-shadow: 0 2px 8px rgba(88, 166, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-primary);
        }

        .btn-outline:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border-accent);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* ===== Main Content ===== */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0;
            flex: 1;
            overflow: hidden;
        }

        /* ===== Panels ===== */
        .panel {
            display: flex;
            flex-direction: column;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-primary);
            overflow: hidden;
        }

        .panel:last-child {
            border-right: none;
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-primary);
            flex-shrink: 0;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .panel-icon {
            width: 16px;
            height: 16px;
            color: var(--accent-cyan);
        }

        .panel-hint {
            font-size: 12px;
            color: var(--text-muted);
        }

        .panel-body {
            flex: 1;
            overflow: auto;
            position: relative;
        }

        /* ===== Code Editor ===== */
        .code-editor {
            width: 100%;
            height: 100%;
            padding: 16px;
            background: var(--bg-input);
            border: none;
            outline: none;
            resize: none;
            font-family: var(--font-mono);
            font-size: 13px;
            line-height: 1.6;
            color: var(--text-primary);
            tab-size: 2;
        }

        .code-editor::placeholder {
            color: var(--text-muted);
        }

        .code-editor:focus {
            background: rgba(13, 17, 23, 0.8);
        }

        /* ===== Output Panel ===== */
        .output-tabs {
            display: flex;
            gap: 4px;
        }

        .tab-btn {
            padding: 6px 12px;
            background: transparent;
            border: none;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-secondary);
        }

        .tab-btn.active {
            color: var(--accent-cyan);
            background: rgba(57, 197, 207, 0.1);
        }

        .output-content {
            padding: 20px;
            min-height: 100%;
            background: #ffffff;
            color: #1a1a1a;
            overflow: auto;
        }

        #output-source {
            background: var(--bg-input);
            color: var(--text-primary);
            white-space: pre-wrap;
            word-break: break-word;
            font-family: var(--font-mono);
            font-size: 13px;
        }

        /* ===== Error Container ===== */
        .error-container {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .error-content {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: rgba(248, 81, 73, 0.15);
            border: 1px solid var(--accent-red);
            border-radius: var(--radius-md);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-lg);
        }

        .error-icon {
            width: 20px;
            height: 20px;
            color: var(--accent-red);
            flex-shrink: 0;
        }

        #error-message {
            color: var(--text-primary);
            font-size: 13px;
            max-width: 600px;
        }

        .error-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            padding: 0 4px;
            line-height: 1;
        }

        .error-close:hover {
            color: var(--text-primary);
        }

        /* ===== Status Bar ===== */
        .status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 6px 20px;
            background: var(--bg-tertiary);
            border-top: 1px solid var(--border-primary);
            font-size: 11px;
            color: var(--text-muted);
            flex-shrink: 0;
        }

        /* ===== Custom Scrollbar ===== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* ===== Responsive ===== */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr 1fr;
                grid-template-rows: 1fr 1fr;
            }

            .panel-output {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr 1fr 1fr;
            }

            .panel-output {
                grid-column: span 1;
            }

            .toolbar {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-badges {
                display: none;
            }
        }

        /* ===== Output Preview Styles (Bootstrap-like) ===== */
        #output-preview {
            font-family: var(--font-sans);
            font-size: 14px;
            line-height: 1.6;
        }

        #output-preview h1,
        #output-preview h2,
        #output-preview h3,
        #output-preview h4,
        #output-preview h5,
        #output-preview h6 {
            margin-bottom: 0.5rem;
            font-weight: 600;
            line-height: 1.3;
            color: #1a1a1a;
        }

        #output-preview h1 {
            font-size: 2rem;
        }

        #output-preview h2 {
            font-size: 1.5rem;
        }

        #output-preview h3 {
            font-size: 1.25rem;
        }

        #output-preview h4 {
            font-size: 1.1rem;
        }

        #output-preview p {
            margin-bottom: 0.75rem;
        }

        #output-preview ul,
        #output-preview ol {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        #output-preview li {
            margin-bottom: 0.25rem;
        }

        /* Tables */
        #output-preview table,
        #output-preview .table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0;
            background: white;
        }

        #output-preview th,
        #output-preview td {
            border: 1px solid #dee2e6;
            padding: 10px 14px;
            text-align: left;
        }

        #output-preview th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        #output-preview tr:nth-child(even) {
            background: #f8f9fa;
        }

        #output-preview tr:hover {
            background: #e9ecef;
        }

        #output-preview .table-light {
            background: #f8f9fa;
        }

        #output-preview .odd-row {
            background: #f8f9fa;
        }

        #output-preview .even-row {
            background: white;
        }

        /* Badges */
        #output-preview .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 500;
            line-height: 1;
        }

        #output-preview .badge-success,
        #output-preview .bg-success {
            background: #d1fae5 !important;
            color: #065f46 !important;
        }

        #output-preview .badge-danger,
        #output-preview .bg-danger {
            background: #fee2e2 !important;
            color: #991b1b !important;
        }

        #output-preview .badge-warning,
        #output-preview .bg-warning {
            background: #fef3c7 !important;
            color: #92400e !important;
        }

        #output-preview .badge-info,
        #output-preview .bg-info {
            background: #dbeafe !important;
            color: #1e40af !important;
        }

        #output-preview .badge-primary,
        #output-preview .bg-primary {
            background: #dbeafe !important;
            color: #1e40af !important;
        }

        #output-preview .badge-secondary,
        #output-preview .bg-secondary {
            background: #e5e7eb !important;
            color: #374151 !important;
        }

        /* Cards */
        #output-preview .card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            margin: 12px 0;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            background: white;
        }

        #output-preview .card-header {
            background: linear-gradient(to bottom, #f9fafb, #f3f4f6);
            padding: 14px 18px;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
        }

        #output-preview .card-body {
            padding: 18px;
        }

        #output-preview .card-footer {
            background: #f9fafb;
            padding: 14px 18px;
            border-top: 1px solid #e5e7eb;
        }

        /* Alerts */
        #output-preview .alert {
            padding: 14px 18px;
            border-radius: 8px;
            margin: 12px 0;
            border-left: 4px solid;
        }

        #output-preview .alert-info {
            background: #dbeafe;
            border-left-color: #3b82f6;
            color: #1e40af;
        }

        #output-preview .alert-success {
            background: #d1fae5;
            border-left-color: #10b981;
            color: #065f46;
        }

        #output-preview .alert-warning {
            background: #fef3c7;
            border-left-color: #f59e0b;
            color: #92400e;
        }

        #output-preview .alert-danger {
            background: #fee2e2;
            border-left-color: #ef4444;
            color: #991b1b;
        }

        #output-preview .alert-secondary {
            background: #f3f4f6;
            border-left-color: #6b7280;
            color: #374151;
        }

        /* List Groups */
        #output-preview .list-group {
            list-style: none;
            padding: 0;
            margin: 12px 0;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        #output-preview .list-group-item {
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
            background: white;
        }

        #output-preview .list-group-item:last-child {
            border-bottom: none;
        }

        #output-preview .list-group-item:hover {
            background: #f9fafb;
        }

        /* Forms */
        #output-preview .form-group {
            margin-bottom: 16px;
        }

        #output-preview .form-control {
            display: block;
            width: 100%;
            padding: 10px 14px;
            font-size: 14px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            color: #374151;
            margin-top: 6px;
        }

        #output-preview .form-control:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        #output-preview label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }

        #output-preview select.form-control {
            cursor: pointer;
        }

        /* Buttons in preview */
        #output-preview .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 18px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            font-size: 14px;
            transition: all 0.15s;
        }

        #output-preview .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        #output-preview .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        #output-preview .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        /* Grid & Layout */
        #output-preview .container {
            max-width: 100%;
            padding: 0;
        }

        #output-preview .row {
            display: flex;
            flex-wrap: wrap;
            margin: -8px;
        }

        #output-preview .col-md-6 {
            flex: 0 0 50%;
            max-width: 50%;
            padding: 8px;
        }

        #output-preview .mb-3 {
            margin-bottom: 12px;
        }

        #output-preview .mt-3 {
            margin-top: 12px;
        }

        #output-preview .me-1 {
            margin-right: 4px;
        }

        /* Text colors */
        #output-preview .text-danger {
            color: #dc2626 !important;
        }

        #output-preview .text-warning {
            color: #d97706 !important;
        }

        #output-preview .text-muted {
            color: #6b7280 !important;
        }

        #output-preview .text-success {
            color: #059669 !important;
        }

        #output-preview .text-info {
            color: #0891b2 !important;
        }

        #output-preview .text-primary {
            color: #2563eb !important;
        }

        /* Sections */
        #output-preview .section {
            margin: 20px 0;
            padding: 16px;
            background: #f9fafb;
            border-radius: 8px;
        }

        /* Page layout fragments */
        #output-preview .page-header {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        #output-preview .page-header h1 {
            color: white;
            margin-bottom: 10px;
        }

        #output-preview .page-header nav a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }

        #output-preview .page-header nav a:hover {
            color: white;
        }

        #output-preview .page-footer {
            background: #1f2937;
            color: #9ca3af;
            padding: 16px 20px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
        }

        #output-preview .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        #output-preview .user-card {
            margin: 0;
        }

        #output-preview .stats-section {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }

        /* Dynamic attributes example */
        #output-preview .dynamic-attrs {
            margin-top: 20px;
        }

        #output-preview .item {
            padding: 16px;
            border-radius: 8px;
            margin: 8px 0;
        }

        #output-preview .item.active {
            border: 2px solid #10b981;
        }

        kbd {
            background: #374151;
            color: #f9fafb;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-family: var(--font-mono);
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
                </svg>
                <h1>Thymeleaf Template Tester</h1>
            </div>
            <div class="header-badges">
                <span class="badge badge-success">Full Spring Boot Support</span>
                <span class="badge badge-info">v3.1 Syntax</span>
            </div>
        </div>
    </header>

    <!-- Toolbar -->
    <div class="toolbar">
        <div class="toolbar-left">
            <label class="toolbar-label">Examples:</label>
            <div class="btn-group">
                <button class="btn btn-outline" onclick="loadSample('basic')">Basic</button>
                <button class="btn btn-outline" onclick="loadSample('iteration')">Iteration</button>
                <button class="btn btn-outline" onclick="loadSample('conditionals')">Conditionals</button>
                <button class="btn btn-outline" onclick="loadSample('utilities')">Utilities</button>
                <button class="btn btn-outline" onclick="loadSample('fragments')">Fragments</button>
                <button class="btn btn-outline" onclick="loadSample('forms')">Forms</button>
            </div>
        </div>
        <div class="toolbar-right">
            <span style="color: var(--text-muted); font-size: 12px;"><kbd>Ctrl</kbd>+<kbd>Enter</kbd></span>
            <button class="btn btn-primary" onclick="render()">
                <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z" />
                </svg>
                Render
            </button>
            <button class="btn btn-ghost" onclick="formatJSON()">Format JSON</button>
            <button class="btn btn-ghost" onclick="clearAll()">Clear</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="panel">
            <div class="panel-header">
                <span class="panel-title">
                    <svg class="panel-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="16 18 22 12 16 6"></polyline>
                        <polyline points="8 6 2 12 8 18"></polyline>
                    </svg>
                    Thymeleaf Template
                </span>
                <span class="panel-hint">HTML with th:* attributes</span>
            </div>
            <div class="panel-body">
                <textarea id="template-input" class="code-editor" spellcheck="false"
                    placeholder="<div th:text='${message}'>Hello</div>"></textarea>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <span class="panel-title">
                    <svg class="panel-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Model Data (JSON)
                </span>
                <span class="panel-hint">Context variables</span>
            </div>
            <div class="panel-body">
                <textarea id="data-input" class="code-editor" spellcheck="false"
                    placeholder='{ "message": "Hello World" }'></textarea>
            </div>
        </div>

        <div class="panel panel-output">
            <div class="panel-header">
                <span class="panel-title">
                    <svg class="panel-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Output
                </span>
                <div class="output-tabs">
                    <button class="tab-btn active" onclick="switchOutputTab('preview')">Preview</button>
                    <button class="tab-btn" onclick="switchOutputTab('source')">HTML Source</button>
                </div>
            </div>
            <div class="panel-body">
                <div id="output-preview" class="output-content"></div>
                <div id="output-source" class="output-content" style="display: none;"></div>
            </div>
        </div>
    </main>

    <!-- Error Display -->
    <div id="error-container" class="error-container" style="display: none;">
        <div class="error-content">
            <svg class="error-icon" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
            </svg>
            <span id="error-message"></span>
            <button class="error-close" onclick="hideError()">√ó</button>
        </div>
    </div>

    <!-- Status Bar -->
    <footer class="status-bar">
        <div class="status-left"><span id="render-status">Ready</span></div>
        <div class="status-right">
            <span>Supported: th:text, th:utext, th:if, th:unless, th:each, th:switch, th:case, th:with, th:attr,
                th:classappend, th:href, th:src, th:object, th:fragment, th:insert, th:replace, th:block</span>
        </div>
    </footer>

    <script src="../../assets/js/thymeleaf-engine.js"></script>
    <script>
        const engine = new ThymeleafEngine();

        const SAMPLES = {
            basic: {
                template: `<div class="container">
    <h1 th:text="\${pageTitle}">Welcome</h1>
    <p th:text="\${message}">Default message</p>
    
    <div class="card" th:if="\${user}">
        <div class="card-header">User Information</div>
        <div class="card-body">
            <p><strong>Name:</strong> <span th:text="\${user.name}">John</span></p>
            <p><strong>Email:</strong> <span th:text="\${user.email}">john@example.com</span></p>
            <p><strong>Role:</strong> <span class="badge bg-info" th:text="\${user.role}">User</span></p>
        </div>
    </div>
    
    <div class="alert alert-warning" th:unless="\${user}">
        No user logged in
    </div>
</div>`,
                data: { pageTitle: "Welcome to Thymeleaf Tester", message: "This is a basic Thymeleaf template demonstration.", user: { name: "Alice Johnson", email: "alice@example.com", role: "Administrator" } }
            },

            iteration: {
                template: `<div class="container">
    <h2 th:text="\${title}">Product List</h2>
    
    <table class="table">
        <thead>
            <tr><th>#</th><th>Product</th><th>Price</th><th>In Stock</th></tr>
        </thead>
        <tbody>
            <tr th:each="product, stat : \${products}" th:class="\${stat.odd} ? 'odd-row' : 'even-row'">
                <td th:text="\${stat.count}">1</td>
                <td th:text="\${product.name}">Product Name</td>
                <td th:text="'\$' + \${product.price}">$0.00</td>
                <td>
                    <span class="badge bg-success" th:if="\${product.inStock}">Yes</span>
                    <span class="badge bg-danger" th:unless="\${product.inStock}">No</span>
                </td>
            </tr>
        </tbody>
    </table>
    
    <p>Total products: <strong th:text="\${#lists.size(products)}">0</strong></p>
    
    <h3>Categories</h3>
    <div th:each="category : \${categories}" class="card mb-3">
        <div class="card-header" th:text="\${category.name}">Category</div>
        <ul class="list-group">
            <li th:each="item : \${category.items}" class="list-group-item" th:text="\${item}">Item</li>
        </ul>
    </div>
</div>`,
                data: { title: "Product Catalog", products: [{ name: "Laptop Pro", price: 1299.99, inStock: true }, { name: "Wireless Mouse", price: 49.99, inStock: true }, { name: "Mechanical Keyboard", price: 159.99, inStock: false }, { name: "4K Monitor", price: 599.99, inStock: true }, { name: "USB-C Hub", price: 79.99, inStock: false }], categories: [{ name: "Electronics", items: ["Phones", "Tablets", "Laptops"] }, { name: "Accessories", items: ["Cases", "Chargers", "Cables"] }] }
            },

            conditionals: {
                template: `<div class="container">
    <h2>Conditional Rendering Examples</h2>
    
    <div class="section">
        <h3>User Status</h3>
        <div th:if="\${user.isActive}" class="alert alert-success">‚úÖ User is active</div>
        <div th:unless="\${user.isActive}" class="alert alert-warning">‚ö†Ô∏è User is inactive</div>
    </div>
    
    <div class="section">
        <h3>Role-Based Content</h3>
        <div th:switch="\${user.role}">
            <div th:case="'admin'" class="alert alert-danger"><strong>üõ°Ô∏è Admin Panel:</strong> You have full access.</div>
            <div th:case="'moderator'" class="alert alert-warning"><strong>üë§ Moderator Panel:</strong> You can manage content.</div>
            <div th:case="'user'" class="alert alert-info"><strong>üìù User Dashboard:</strong> Welcome to your dashboard.</div>
            <div th:case="*" class="alert alert-secondary"><strong>üëã Guest:</strong> Please log in.</div>
        </div>
    </div>
    
    <div class="section">
        <h3>Score: <span th:text="\${score}">0</span></h3>
        <span th:if="\${score >= 90}" class="badge bg-success">Excellent!</span>
        <span th:if="\${score >= 70 and score < 90}" class="badge bg-info">Good</span>
        <span th:if="\${score >= 50 and score < 70}" class="badge bg-warning">Average</span>
        <span th:if="\${score < 50}" class="badge bg-danger">Needs Improvement</span>
    </div>
    
    <div class="section">
        <h3>Conditional Expressions</h3>
        <p>Status: <span th:text="\${user.isActive} ? 'üü¢ Online' : 'üî¥ Offline'">Status</span></p>
        <p>Nickname: <span th:text="\${user.nickname} ?: 'No nickname set'">Nickname</span></p>
        <p>Premium: <span th:text="\${user.isPremium} ? '‚≠ê Premium Member' : 'Standard Member'">Member</span></p>
    </div>
</div>`,
                data: { user: { name: "Bob Smith", role: "admin", isActive: true, isPremium: true, nickname: null }, score: 85 }
            },

            utilities: {
                template: `<div class="container">
    <h2>Utility Objects Demo</h2>
    
    <div class="card">
        <div class="card-header">#strings Utilities</div>
        <div class="card-body">
            <table class="table">
                <tr><td>Original:</td><td><strong th:text="\${text}">text</strong></td></tr>
                <tr><td>Upper Case:</td><td th:text="\${#strings.toUpperCase(text)}">TEXT</td></tr>
                <tr><td>Lower Case:</td><td th:text="\${#strings.toLowerCase(text)}">text</td></tr>
                <tr><td>Capitalize:</td><td th:text="\${#strings.capitalize(text)}">Text</td></tr>
                <tr><td>Length:</td><td th:text="\${#strings.length(text)}">0</td></tr>
                <tr><td>Abbreviate (15):</td><td th:text="\${#strings.abbreviate(longText, 15)}">...</td></tr>
                <tr><td>Contains 'world':</td><td th:text="\${#strings.contains(text, 'world')}">false</td></tr>
            </table>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">#numbers Utilities</div>
        <div class="card-body">
            <table class="table">
                <tr><td>Original:</td><td><strong th:text="\${amount}">0</strong></td></tr>
                <tr><td>Format Decimal:</td><td th:text="\${#numbers.formatDecimal(amount, 1, 'COMMA', 2, 'POINT')}">0.00</td></tr>
                <tr><td>Format Integer (5 digits):</td><td th:text="\${#numbers.formatInteger(count, 5)}">00000</td></tr>
                <tr><td>Currency Format:</td><td th:text="\${#numbers.formatCurrency(amount, 'en-US', 'USD')}">$0.00</td></tr>
                <tr><td>Percent Format:</td><td th:text="\${#numbers.formatPercent(percentage, 1, 2)}">0%</td></tr>
            </table>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">#temporals Utilities</div>
        <div class="card-body">
            <table class="table">
                <tr><td>Original:</td><td><strong th:text="\${dateTime}">date</strong></td></tr>
                <tr><td>Format (dd/MM/yyyy):</td><td th:text="\${#temporals.format(dateTime, 'dd/MM/yyyy')}">01/01/2024</td></tr>
                <tr><td>Format (yyyy-MM-dd HH:mm):</td><td th:text="\${#temporals.format(dateTime, 'yyyy-MM-dd HH:mm')}">2024-01-01 00:00</td></tr>
                <tr><td>Full Date:</td><td th:text="\${#temporals.format(dateTime, 'EEEE, MMMM d, yyyy')}">Monday, January 1, 2024</td></tr>
                <tr><td>Day of Week:</td><td th:text="\${#temporals.dayOfWeekName(dateTime)}">Monday</td></tr>
                <tr><td>Month Name:</td><td th:text="\${#temporals.monthName(dateTime)}">January</td></tr>
            </table>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">#lists & #aggregates</div>
        <div class="card-body">
            <p>Numbers: <strong th:text="\${#strings.arrayJoin(numbers, ', ')}">list</strong></p>
            <table class="table">
                <tr><td>Size:</td><td th:text="\${#lists.size(numbers)}">0</td></tr>
                <tr><td>Contains 42:</td><td th:text="\${#lists.contains(numbers, 42)}">false</td></tr>
                <tr><td>Sum:</td><td th:text="\${#aggregates.sum(numbers)}">0</td></tr>
                <tr><td>Average:</td><td th:text="\${#aggregates.avg(numbers)}">0</td></tr>
                <tr><td>Max:</td><td th:text="\${#aggregates.max(numbers)}">0</td></tr>
                <tr><td>Min:</td><td th:text="\${#aggregates.min(numbers)}">0</td></tr>
            </table>
        </div>
    </div>
</div>`,
                data: { text: "Hello World", longText: "This is a very long text that should be abbreviated", amount: 12345.6789, count: 42, percentage: 0.8567, dateTime: "2024-06-15T14:30:45", numbers: [10, 25, 42, 18, 55, 33, 7] }
            },

            fragments: {
                template: `<!-- Fragment definitions -->
<th:block th:fragment="header(title)">
    <header class="page-header">
        <h1 th:text="\${title}">Page Title</h1>
        <nav><a href="/">Home</a> | <a href="/about">About</a> | <a href="/contact">Contact</a></nav>
    </header>
</th:block>

<th:block th:fragment="userCard(user)">
    <div class="card user-card">
        <div class="card-header" th:text="\${user.name}">User Name</div>
        <div class="card-body">
            <p>Email: <span th:text="\${user.email}">email@example.com</span></p>
            <p>Role: <span class="badge bg-info" th:text="\${user.role}">Role</span></p>
        </div>
    </div>
</th:block>

<th:block th:fragment="footer">
    <footer class="page-footer">
        <p>&copy; 2024 Thymeleaf Tester. All rights reserved.</p>
    </footer>
</th:block>

<!-- Main content using fragments -->
<div class="page-wrapper">
    <div th:insert="~{header(\${pageTitle})}"></div>
    
    <main>
        <h2>Team Members</h2>
        <div class="user-grid">
            <div th:each="member : \${team}" th:insert="~{userCard(\${member})}"></div>
        </div>
        
        <th:block th:if="\${showStats}">
            <div class="stats-section">
                <h3>üìä Team Statistics</h3>
                <p>Total members: <strong th:text="\${#lists.size(team)}">0</strong></p>
            </div>
        </th:block>
    </main>
    
    <div th:insert="~{footer}"></div>
</div>`,
                data: { pageTitle: "Our Team", showStats: true, team: [{ name: "John Doe", email: "john@example.com", role: "Lead Developer" }, { name: "Jane Smith", email: "jane@example.com", role: "Designer" }, { name: "Bob Johnson", email: "bob@example.com", role: "Backend Developer" }] }
            },

            forms: {
                template: `<div class="container">
    <h2>Form Example</h2>
    
    <form th:action="@{/submit}" method="post" th:object="\${formData}">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" class="form-control" th:value="*{name}" th:placeholder="'Enter your name'">
        </div>
        
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" class="form-control" th:value="*{email}" th:placeholder="'Enter your email'">
        </div>
        
        <div class="form-group">
            <label for="country">Country:</label>
            <select id="country" name="country" class="form-control">
                <option value="">-- Select Country --</option>
                <option th:each="country : \${countries}" th:value="\${country.code}" th:text="\${country.name}" th:selected="\${country.code == formData.country}">Country</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Subscription Plan:</label>
            <div th:each="plan : \${plans}">
                <label style="font-weight: normal; display: flex; gap: 8px; align-items: center; margin: 4px 0;">
                    <input type="radio" name="subscription" th:value="\${plan.id}" th:checked="\${plan.id == formData.subscription}">
                    <span th:text="\${plan.name}">Plan</span>
                    <span style="color: #6b7280;" th:text="'(' + \${plan.price} + '/month)'">($0/month)</span>
                </label>
            </div>
        </div>
        
        <div class="form-group">
            <label style="font-weight: normal; display: flex; gap: 8px; align-items: center;">
                <input type="checkbox" name="agree" th:checked="\${formData.agreedToTerms}">
                I agree to the Terms of Service
            </label>
        </div>
        
        <button type="submit" class="btn btn-primary" th:disabled="\${not formData.agreedToTerms}">Submit</button>
    </form>
    
    <div class="section mt-3">
        <h3>Dynamic Attributes</h3>
        <div th:attr="data-id=\${item.id}, data-category=\${item.category}" th:class="'item ' + \${item.status}" th:style="'background-color: ' + \${item.color}">
            <p th:text="\${item.name}">Item</p>
        </div>
    </div>
</div>`,
                data: { formData: { name: "John Doe", email: "john@example.com", country: "US", subscription: "pro", agreedToTerms: true }, countries: [{ code: "US", name: "United States" }, { code: "UK", name: "United Kingdom" }, { code: "CA", name: "Canada" }, { code: "AU", name: "Australia" }], plans: [{ id: "free", name: "Free", price: "$0" }, { id: "basic", name: "Basic", price: "$9.99" }, { id: "pro", name: "Professional", price: "$19.99" }, { id: "enterprise", name: "Enterprise", price: "$49.99" }], item: { id: "item-123", category: "electronics", status: "active", color: "#e3f2fd", name: "Sample Product" } }
            }
        };

        function loadSample(type) {
            const sample = SAMPLES[type];
            if (sample) {
                document.getElementById('template-input').value = sample.template;
                document.getElementById('data-input').value = JSON.stringify(sample.data, null, 2);
                render();
            }
        }

        function render() {
            const template = document.getElementById('template-input').value;
            const dataStr = document.getElementById('data-input').value;
            const previewEl = document.getElementById('output-preview');
            const sourceEl = document.getElementById('output-source');
            hideError();
            updateStatus('Rendering...');
            const startTime = performance.now();

            try {
                const context = dataStr.trim() ? JSON.parse(dataStr) : {};
                const result = engine.render(template, context);
                previewEl.innerHTML = result;
                sourceEl.textContent = formatHtml(result);
                updateStatus(`Rendered in ${(performance.now() - startTime).toFixed(2)}ms`);
            } catch (e) {
                showError(e.message);
                updateStatus('Error');
            }
        }

        function switchOutputTab(tab) {
            const previewEl = document.getElementById('output-preview');
            const sourceEl = document.getElementById('output-source');
            const tabs = document.querySelectorAll('.tab-btn');
            tabs.forEach(t => t.classList.remove('active'));
            if (tab === 'preview') {
                previewEl.style.display = 'block';
                sourceEl.style.display = 'none';
                tabs[0].classList.add('active');
            } else {
                previewEl.style.display = 'none';
                sourceEl.style.display = 'block';
                tabs[1].classList.add('active');
            }
        }

        function formatJSON() {
            const dataInput = document.getElementById('data-input');
            try {
                dataInput.value = JSON.stringify(JSON.parse(dataInput.value), null, 2);
            } catch (e) { showError('Invalid JSON: ' + e.message); }
        }

        function clearAll() {
            document.getElementById('template-input').value = '';
            document.getElementById('data-input').value = '{}';
            document.getElementById('output-preview').innerHTML = '';
            document.getElementById('output-source').textContent = '';
            updateStatus('Ready');
        }

        function showError(msg) {
            document.getElementById('error-message').textContent = msg;
            document.getElementById('error-container').style.display = 'block';
        }
        function hideError() { document.getElementById('error-container').style.display = 'none'; }
        function updateStatus(s) { document.getElementById('render-status').textContent = s; }

        function formatHtml(html) {
            let formatted = '', indent = 0;
            html.replace(/></g, '>\n<').split('\n').forEach(line => {
                line = line.trim();
                if (!line) return;
                if (line.match(/^<\/\w/) && indent > 0) indent--;
                formatted += '  '.repeat(indent) + line + '\n';
                if (line.match(/^<\w[^>]*[^\/]>$/) && !line.match(/^<(br|hr|img|input|meta|link)/i)) indent++;
            });
            return formatted.trim();
        }

        document.addEventListener('DOMContentLoaded', () => loadSample('basic'));
        document.addEventListener('keydown', e => { if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') { e.preventDefault(); render(); } });
    </script>
</body>

</html>