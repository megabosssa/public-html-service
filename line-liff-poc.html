<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF Example</title>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        function initializeLiff(myLiffId) {
            liff.init({
                liffId: myLiffId
            }).then(() => {
                // Check if the user is logged in
                if (!liff.isLoggedIn()) {
                    // If not logged in, login
                    liff.login();
                } else {
                    // If logged in, get the access token and user profile
                    const accessToken = liff.getAccessToken();
                    console.log("Access Token:", accessToken);

                    liff.getProfile().then(profile => {
                        const userId = profile.userId;
                        console.log("User ID:", userId);

                        // Open the specified URL with accessToken
                        const url = `https://xxx/line/generateSession?accessToken=${accessToken}`;
                        liff.openWindow({
                            url: url,
                            external: true // Set to true to open the URL in the browser
                        });
                    }).catch(err => {
                        console.error("Error getting profile:", err);
                    });
                }
            }).catch((err) => {
                console.error('LIFF Initialization failed', err);
            });
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            // Replace with your LIFF ID
            const myLiffId = "YOUR_LIFF_ID";
            initializeLiff(myLiffId);
        });
    </script>
</head>
<body>
    <h1></h1>
</body>
</html>
