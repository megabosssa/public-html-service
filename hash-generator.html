<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Generate MD5, SHA-1, SHA-256, and SHA-512 hashes for text and files">
    <title>Hash Generator | Dev Tools</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="shared-styles.css">
    <style>
        .hash-result {
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 0.75rem;
        }

        .hash-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .hash-label span {
            font-weight: 600;
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        .hash-value {
            font-family: var(--font-mono);
            font-size: var(--font-size-sm);
            word-break: break-all;
            padding: 0.5rem;
            background: var(--color-bg-secondary);
            border-radius: var(--radius-sm);
            border: 1px solid var(--color-border);
        }

        .hash-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .hash-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .hash-option input {
            width: 18px;
            height: 18px;
        }

        .file-hash-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--color-border);
        }

        .drop-zone {
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-lg);
            padding: 2rem;
            text-align: center;
            color: var(--color-text-muted);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .drop-zone:hover,
        .drop-zone.dragover {
            border-color: var(--color-accent);
            background: var(--color-accent-light);
        }

        .drop-zone i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--color-bg-tertiary);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 1rem;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: var(--color-accent);
            transition: width 0.1s;
        }
    </style>
</head>

<body>
    <div class="tool-container">
        <a href="index.html" class="nav-back"><i class="bi bi-arrow-left"></i> Back to Tools</a>

        <header class="tool-header">
            <h1><i class="bi bi-hash"></i> Hash Generator</h1>
            <div class="tool-actions"></div>
        </header>

        <div class="split-container">
            <!-- Text Hashing -->
            <div class="panel">
                <h2 class="panel-title" style="margin-bottom: 1rem;">
                    <i class="bi bi-text-left"></i> Text Input
                </h2>

                <div class="form-group">
                    <label class="form-label">Enter text to hash</label>
                    <textarea id="textInput" class="form-textarea code" rows="6"
                        placeholder="Enter text to generate hashes..."></textarea>
                </div>

                <div class="hash-options">
                    <label class="hash-option">
                        <input type="checkbox" id="hashMD5" checked>
                        <span>MD5</span>
                    </label>
                    <label class="hash-option">
                        <input type="checkbox" id="hashSHA1" checked>
                        <span>SHA-1</span>
                    </label>
                    <label class="hash-option">
                        <input type="checkbox" id="hashSHA256" checked>
                        <span>SHA-256</span>
                    </label>
                    <label class="hash-option">
                        <input type="checkbox" id="hashSHA512">
                        <span>SHA-512</span>
                    </label>
                </div>

                <button type="button" class="btn btn-primary" id="hashTextBtn">
                    <i class="bi bi-hash"></i> Generate Hashes
                </button>

                <div style="font-size: var(--font-size-sm); color: var(--color-text-muted); margin-top: 0.5rem;">
                    <kbd>Ctrl</kbd> + <kbd>Enter</kbd> to hash
                </div>
            </div>

            <!-- Hash Results -->
            <div class="panel">
                <h2 class="panel-title" style="margin-bottom: 1rem;">
                    <i class="bi bi-list-check"></i> Hash Results
                </h2>

                <div id="hashResults">
                    <p style="color: var(--color-text-muted);">Enter text and click "Generate Hashes" to see results...
                    </p>
                </div>
            </div>
        </div>

        <!-- File Hashing -->
        <div class="panel file-hash-section">
            <h2 class="panel-title" style="margin-bottom: 1rem;">
                <i class="bi bi-file-earmark-binary"></i> File Hashing
            </h2>

            <div id="dropZone" class="drop-zone">
                <i class="bi bi-cloud-upload"></i>
                <div>Drop a file here or click to browse</div>
                <div style="font-size: var(--font-size-xs); margin-top: 0.5rem;">Supports any file type</div>
                <input type="file" id="fileInput" style="display: none;">
            </div>

            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div id="fileInfo" style="margin-top: 1rem; display: none;">
                <div class="status-message status-success" id="fileStatus"></div>
            </div>

            <div id="fileHashResults" style="margin-top: 1rem;"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
    <script src="shared-utils.js"></script>
    <script>
        // DOM Elements
        const textInput = document.getElementById('textInput');
        const hashTextBtn = document.getElementById('hashTextBtn');
        const hashResults = document.getElementById('hashResults');
        const fileInput = document.getElementById('fileInput');
        const dropZone = document.getElementById('dropZone');
        const fileHashResults = document.getElementById('fileHashResults');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const fileInfo = document.getElementById('fileInfo');
        const fileStatus = document.getElementById('fileStatus');

        // Initialize tool
        initTool({
            toolName: 'hash',
            onExecute: hashText,
            onHistorySelect: (value) => {
                textInput.value = value;
                hashText();
            },
            getShareData: () => ({ text: textInput.value })
        });

        // Event listeners
        hashTextBtn.addEventListener('click', hashText);

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            if (e.dataTransfer.files[0]) hashFile(e.dataTransfer.files[0]);
        });
        fileInput.addEventListener('change', (e) => {
            if (e.target.files[0]) hashFile(e.target.files[0]);
        });

        async function hashText() {
            const text = textInput.value;
            if (!text) {
                hashResults.innerHTML = '<p style="color: var(--color-danger);">Please enter some text to hash</p>';
                return;
            }

            HistoryManager.addToHistory('hash', text);
            const hashes = [];

            if (document.getElementById('hashMD5').checked) {
                hashes.push({ name: 'MD5', value: CryptoJS.MD5(text).toString() });
            }
            if (document.getElementById('hashSHA1').checked) {
                hashes.push({ name: 'SHA-1', value: CryptoJS.SHA1(text).toString() });
            }
            if (document.getElementById('hashSHA256').checked) {
                hashes.push({ name: 'SHA-256', value: CryptoJS.SHA256(text).toString() });
            }
            if (document.getElementById('hashSHA512').checked) {
                hashes.push({ name: 'SHA-512', value: CryptoJS.SHA512(text).toString() });
            }

            renderHashResults(hashResults, hashes);
        }

        async function hashFile(file) {
            fileInfo.style.display = 'block';
            fileStatus.textContent = `Hashing: ${file.name} (${formatBytes(file.size)})...`;
            progressBar.style.display = 'block';
            progressFill.style.width = '0%';
            fileHashResults.innerHTML = '';

            const reader = new FileReader();

            reader.onprogress = (e) => {
                if (e.lengthComputable) {
                    const percent = (e.loaded / e.total) * 100;
                    progressFill.style.width = percent + '%';
                }
            };

            reader.onload = async (e) => {
                const wordArray = CryptoJS.lib.WordArray.create(e.target.result);

                const hashes = [];

                if (document.getElementById('hashMD5').checked) {
                    hashes.push({ name: 'MD5', value: CryptoJS.MD5(wordArray).toString() });
                }
                if (document.getElementById('hashSHA1').checked) {
                    hashes.push({ name: 'SHA-1', value: CryptoJS.SHA1(wordArray).toString() });
                }
                if (document.getElementById('hashSHA256').checked) {
                    hashes.push({ name: 'SHA-256', value: CryptoJS.SHA256(wordArray).toString() });
                }
                if (document.getElementById('hashSHA512').checked) {
                    hashes.push({ name: 'SHA-512', value: CryptoJS.SHA512(wordArray).toString() });
                }

                progressFill.style.width = '100%';
                fileStatus.textContent = `Completed: ${file.name} (${formatBytes(file.size)})`;

                setTimeout(() => {
                    progressBar.style.display = 'none';
                }, 500);

                renderHashResults(fileHashResults, hashes);
            };

            reader.readAsArrayBuffer(file);
        }

        function renderHashResults(container, hashes) {
            if (hashes.length === 0) {
                container.innerHTML = '<p style="color: var(--color-text-muted);">Select at least one hash algorithm</p>';
                return;
            }

            container.innerHTML = hashes.map(h => `
                <div class="hash-result">
                    <div class="hash-label">
                        <span>${h.name}</span>
                        <button class="btn btn-secondary copy-btn" onclick="copyHash('${h.value}')">
                            <i class="bi bi-clipboard"></i> Copy
                        </button>
                    </div>
                    <div class="hash-value">${h.value}</div>
                </div>
            `).join('');
        }

        function copyHash(hash) {
            copyToClipboard(hash);
            showCopyFeedback('Hash copied!');
        }

        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>

</html>